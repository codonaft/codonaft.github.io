---
permalink: /searxng
---

<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<link rel="icon" href="https://searx.space/favicon.png" sizes="any">
<link rel="icon" href="https://searx.space/favicon.svg" type="image/svg+xml">
<link rel="apple-touch-icon" href="https://searx.space/favicon.png">
<title>SearXNG Random Instance Redirector</title>
<style>code { background-color: rgba(128, 128, 128, 0.4); padding: 0.1rem 0.25rem 0.1rem 0.25rem }</style>
</head>
<body>
<script type="module">
import { detectAll } from '{{ site.url }}/assets/js/vendor/tinyld.min.js';

const MIN_MONTH_UPTIME = 95;
const FALLBACKS = ['paulgo.io', 'search.im-in.space', 'search.ononoki.org', 'search.undertale.uk', 'searx.bndkt.io', 'searx.oloke.xyz'];

const params = new URLSearchParams(window.location.search);

const loadInstances = async () => {
 const fallbacks = FALLBACKS.map(i => `https://${i}/`);
 if (params.get('fast') === '1') return fallbacks;

 const response = await fetch('https://searx.space/data/instances.json');
 if (!response.ok) {
  console.log('fallback');
  return fallbacks;
 }

 const instances = (await response.json()).instances;
 console.log('instances', instances);

 const onion = window.location.host.endsWith('.onion');
 const best = Object
  .entries(instances)
  .filter(([u, i]) => {
   try {
    const url = new URL(u);
    if (onion) {
     if (i.network_type !== 'tor') return false;
    } else {
     if (i.network_type !== 'normal' || url.protocol !== 'https:' || i.tls.grade !== 'A+') return false;
    }
    return i.uptime.uptimeMonth >= MIN_MONTH_UPTIME && i.uptime.uptimeDay === 100 && !i.analytics && i.engines.duckduckgo?.error_rate < 2 && i.engines.google?.error_rate < 2;
   } catch(e) {
    return false;
   }
  })
  .map(([u, _]) => u);

 console.log('best', best);
 return best;
};

const detectLanguage = query => {
 const en = 'en';
 const allowedLanguages = params.get('allowed_languages');
 const only = allowedLanguages ? allowedLanguages.split(',') : [en];
 console.log('allowed languages', only);
 if (only.length <= 1) return en;

 const all = detectAll(query, { only });
 console.log('detected languages', all);

 const detected = all
  .filter(i => i.accuracy > 0.01)
  .sort((a, b) => b.accuracy - a.accuracy);
 if (detected.length === 0) return en;

 return detected[0].lang;
};

const redirect = (url, queryFromForm) => {
 params
  .entries()
  .filter(([k, _]) => k !== 'fast' && k !== 'allowed_languages')
  .forEach(([k, v]) => url.searchParams.set(k, v));
 url.searchParams.set('language', detectLanguage(params.get('q') || queryFromForm));
 if (queryFromForm) {
  url.searchParams.set('q', queryFromForm)
  window.location.href = url.toString();
 } else {
  window.location.replace(url.toString());
 }
};

const pick = xs => xs[Math.floor(Math.random() * xs.length)];
const targetUrl = new URL(pick(await loadInstances()));
targetUrl.pathname = '/search';
targetUrl.searchParams.set('safesearch', params.get('safesearch') || '0');

if (params.has('q')) {
 redirect(targetUrl);
} else {
 const pageUrl = window.location.origin + window.location.pathname;
 document.body.innerHTML = `<p>Redirect to <a rel="noopener noreferrer nofollow" href="${pageUrl}?q=">random SearXNG</a> instance</p><p>This page accepts SearXNG <a target="_blank" href="https://docs.searxng.org/dev/search_api.html">GET parameters</a> and optional parameters:<p><p><ul><li><code>fast=1</code> for hardcoded instances</li><li><code>allowed_languages=en,fr,ru</code> for automatic language filter derived from the query</li></ul></p><p>Example for browser search engine settings (<code>about:preferences#search</code> or <code>chrome://settings/search</code>): <code>${pageUrl}?q=%s&fast=1&image_proxy=True&categories=images</code></p><p>Use this page locally for the best performance: <code>wget ${pageUrl} -O searxng.html</code></p><p>Additionally can be combined with the Violentmonkey <a target="_blank" href="https://userscripts.codonaft.com/searxng-redirect-on-failure.js">userscript</a> to handle search errors</p>`;

 const input = document.createElement('input');
 input.name = 'q';
 input.placeholder = 'Search for...';
 input.autocomplete = 'off';
 input.autocapitalize = 'none';
 input.spellcheck = false;
 input.autocorrect = 'off';
 input.dir = 'auto';
 input.style.width = '99%';

 const form = document.createElement('form');
 form.addEventListener('submit', event => {
  event.preventDefault();
  redirect(targetUrl, input.value);
 });

 form.appendChild(input);
 document.body.appendChild(form);
}
</script>
</body>
</html>
